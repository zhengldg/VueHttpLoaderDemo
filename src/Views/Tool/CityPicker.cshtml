@{
    Layout = "~/Views/Shared/_Layout.V2.cshtml";
}
<div class="pd010" ng-controller="indexCtrl as vm">
    <div class="layui-row" lay-filter="form1">
        <div class="layui-form data-sethead">
            <div class="layui-inline">
                <input type="text" style="width:200px" placeholder="请输入行政区划名称\代码" class="layui-input" ng-model="vm.filter.Filter">
            </div>
            <button class="layui-btn layui-btn-sm layui-btn-green " ng-click="vm.searchTable()">搜索</button>
        </div>
        <table id="grid" lay-filter="grid"></table>
    </div>
</div>

@section script{
    <script>
        angular.module("app.dev")
            .controller("indexCtrl", ["$scope", "pdActionSvr", "pdResourceSvr", 'pdTableSvr', function ($scope, pdActionSvr, pdResourceSvr, pdTableSvr) {

                var url = '@Url.Action("GetCitysPage", "RegionalismCode", new { area = "SysConfig" })';
                var table = {};
                var vm = this;
                vm.filter = { sortfield: 'XZQHDM', Filter: '' };

                vm.init = function () {
                    table = pdTableSvr.render({
                        elem: '#grid',
                        url: url,
                        where: vm.filter,
                        cols: [[
                            { type: 'numbers' },
                            { field: 'XZQHDM', title: '行政区划代码', width: '25%', align: 'center', style: $$.styles.al },
                            { field: 'XZQH', title: '行政区划名称', width: '30%', style: $$.styles.al },
                            {
                                field: 'SFYX', title: '状态', width: '15%', templet: function (record) {
                                    if (record.SFYX == 1) {
                                        return '有效';
                                    } else {
                                        return '无效';
                                    }
                                }
                            },
                            { title: '操作', fixed: 'right', toolbar: '#eventBar' }
                        ]]
                    });
                }

                layui.table.on('tool(grid)', function (obj) {
                    if (obj.event === 'ok') {
                        parent.layer.close(parent.layer.getFrameIndex(window.name), obj.data);
                    }
                })

                vm.searchTable = function () {
                    table.reload({
                        where: vm.filter,
                        page: true
                    });
                }

                vm.save = function () {
                    var checkStatus = layui.table.checkStatus('grid');
                    console.log(checkStatus);
                }

                reload = function () {
                    table.reload()
                }

                vm.init();
            }]);
    </script>

    <script type="text/html" id="eventBar">
        <a class="layui-btn layui-btn-xs layui-btn-normal" lay-event="ok">确定</a>
    </script>
}